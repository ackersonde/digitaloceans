{
   "ignition": { "version": "2.2.0" },
   "systemd": {
     "units": [
       {
         "name": "docker.service",
         "enable": true
       }
     ]
   },
   "passwd": {
    "users": [{
      "name": "{{deploy_user}}",
      "passwordHash": "{{console_passwd_hash}}",
      "sshAuthorizedKeys": [ "{{circleci_deploy_pubkey}}", "{{login_ssh_pubkey}}" ],
      "groups": ["sudo", "docker"]
    }]
  },
  "storage": {
    "files": [{
        "filesystem": "root",
        "path": "/etc/ssh/sshd_config",
        "contents": { "source": "data:text/plain;base64,{{encoded_sshd_config}}" }
      },
      {
        "filesystem":"root",
        "path":"/etc/logrotate.d/traefik",
        "mode": 644,
        "contents": {
          "source": "data:,%2Fhome%2F{{deploy_user}}%2Ftraefik%2Flogs%2F*log%20%7B\n%20rotate%209\n%20size%20500M\n%20daily\n%20compress\n%20delaycompress\n%20sharedscripts\n%20postrotate\n\t%2Fusr%2Fbin%2Fdocker%20kill%20--signal%3D%22SIGUSR1%22%20traefik\n%20endscript\n%7D\n"
        }
      }]
  }
}
